#!/bin/bash
set -o nounset

if [ $# != 4 ]; then
	echo "Invalid arguments."
	echo "Try: $0 <Project Name> <Number of Group> <Number of Total Slaves per Group> <Number of Total HW Slaves>"
	exit
fi


echo "██╗  ██╗ █████╗ ██████╗  █████╗ ██████╗  █████╗      ██████╗ ███████╗███╗   ██╗"
echo "██║  ██║██╔══██╗██╔══██╗██╔══██╗██╔══██╗██╔══██╗    ██╔════╝ ██╔════╝████╗  ██║"
echo "███████║███████║██████╔╝███████║██████╔╝███████║    ██║  ███╗█████╗  ██╔██╗ ██║"
echo "██╔══██║██╔══██║██╔═══╝ ██╔══██║██╔══██╗██╔══██║    ██║   ██║██╔══╝  ██║╚██╗██║"
echo "██║  ██║██║  ██║██║     ██║  ██║██║  ██║██║  ██║    ╚██████╔╝███████╗██║ ╚████║"
echo "╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝     ╚═════╝ ╚══════╝╚═╝  ╚═══╝"

if [ -d ./$1 ]; then
	echo "ERROR: Project $1 exists."
	echo "Please try another project name."
fi

echo "██╗  ██╗██╗     ███████╗     ██████╗ ███████╗███╗   ██╗"
echo "██║  ██║██║     ██╔════╝    ██╔════╝ ██╔════╝████╗  ██║"
echo "███████║██║     ███████╗    ██║  ███╗█████╗  ██╔██╗ ██║"
echo "██╔══██║██║     ╚════██║    ██║   ██║██╔══╝  ██║╚██╗██║"
echo "██║  ██║███████╗███████║    ╚██████╔╝███████╗██║ ╚████║"
echo "╚═╝  ╚═╝╚══════╝╚══════╝     ╚═════╝ ╚══════╝╚═╝  ╚═══╝"

# vivado_hls -f hls_config.tcl all


echo "██╗  ██╗██╗    ██╗    ███████╗██████╗  █████╗ ███╗   ███╗███████╗██╗    ██╗ ██████╗ ██████╗ ██╗  ██╗"
echo "██║  ██║██║    ██║    ██╔════╝██╔══██╗██╔══██╗████╗ ████║██╔════╝██║    ██║██╔═══██╗██╔══██╗██║ ██╔╝"
echo "███████║██║ █╗ ██║    █████╗  ██████╔╝███████║██╔████╔██║█████╗  ██║ █╗ ██║██║   ██║██████╔╝█████╔╝ "
echo "██╔══██║██║███╗██║    ██╔══╝  ██╔══██╗██╔══██║██║╚██╔╝██║██╔══╝  ██║███╗██║██║   ██║██╔══██╗██╔═██╗ "
echo "██║  ██║╚███╔███╔╝    ██║     ██║  ██║██║  ██║██║ ╚═╝ ██║███████╗╚███╔███╔╝╚██████╔╝██║  ██║██║  ██╗"
echo "╚═╝  ╚═╝ ╚══╝╚══╝     ╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝╚══════╝ ╚══╝╚══╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝"

vivado -mode batch -source generate.tcl -tclargs $1 $2 $3 $4

echo "███████╗██████╗ ██╗  ██╗     ██████╗ ███████╗███╗   ██╗"
echo "██╔════╝██╔══██╗██║ ██╔╝    ██╔════╝ ██╔════╝████╗  ██║"
echo "███████╗██║  ██║█████╔╝     ██║  ███╗█████╗  ██╔██╗ ██║"
echo "╚════██║██║  ██║██╔═██╗     ██║   ██║██╔══╝  ██║╚██╗██║"
echo "███████║██████╔╝██║  ██╗    ╚██████╔╝███████╗██║ ╚████║"
echo "╚══════╝╚═════╝ ╚═╝  ╚═╝     ╚═════╝ ╚══════╝╚═╝  ╚═══╝"

# xsdk -batch -source sdk_config.tcl $1 $2 $3 $4

echo "██████╗ ███████╗████████╗ █████╗ ██╗     ██╗███╗   ██╗██╗   ██╗██╗  ██╗     ██████╗ ███████╗███╗   ██╗"
echo "██╔══██╗██╔════╝╚══██╔══╝██╔══██╗██║     ██║████╗  ██║██║   ██║╚██╗██╔╝    ██╔════╝ ██╔════╝████╗  ██║"
echo "██████╔╝█████╗     ██║   ███████║██║     ██║██╔██╗ ██║██║   ██║ ╚███╔╝     ██║  ███╗█████╗  ██╔██╗ ██║"
echo "██╔═══╝ ██╔══╝     ██║   ██╔══██║██║     ██║██║╚██╗██║██║   ██║ ██╔██╗     ██║   ██║██╔══╝  ██║╚██╗██║"
echo "██║     ███████╗   ██║   ██║  ██║███████╗██║██║ ╚████║╚██████╔╝██╔╝ ██╗    ╚██████╔╝███████╗██║ ╚████║"
echo "╚═╝     ╚══════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝╚═╝╚═╝  ╚═══╝ ╚═════╝ ╚═╝  ╚═╝     ╚═════╝ ╚══════╝╚═╝  ╚═══╝"


# ./petalinux_config.sh $1

echo " ██████╗██╗     ███████╗ █████╗ ███╗   ██╗██╗   ██╗██████╗ "
echo "██╔════╝██║     ██╔════╝██╔══██╗████╗  ██║██║   ██║██╔══██╗"
echo "██║     ██║     █████╗  ███████║██╔██╗ ██║██║   ██║██████╔╝"
echo "██║     ██║     ██╔══╝  ██╔══██║██║╚██╗██║██║   ██║██╔═══╝ "
echo "╚██████╗███████╗███████╗██║  ██║██║ ╚████║╚██████╔╝██║     "
echo " ╚═════╝╚══════╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝ ╚═╝     "

./clean_up.sh